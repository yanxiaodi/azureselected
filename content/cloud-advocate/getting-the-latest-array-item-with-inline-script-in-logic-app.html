<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Getting the Latest Array Item with Inline Script in Logic App | Azure 中文精选</title>
    <meta name="description" content="">
    <link rel="icon" href="/favicon.ico">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.44111ffa.css" as="style"><link rel="preload" href="/assets/js/app.4ac3a6ef.js" as="script"><link rel="preload" href="/assets/js/2.5f974afc.js" as="script"><link rel="preload" href="/assets/js/16.1df4917f.js" as="script"><link rel="preload" href="/assets/js/5.90cdf109.js" as="script"><link rel="prefetch" href="/assets/js/10.d4e6ccf5.js"><link rel="prefetch" href="/assets/js/11.2777b637.js"><link rel="prefetch" href="/assets/js/12.4a067d6a.js"><link rel="prefetch" href="/assets/js/13.174cb259.js"><link rel="prefetch" href="/assets/js/14.2bcf7b7f.js"><link rel="prefetch" href="/assets/js/15.a4df89a3.js"><link rel="prefetch" href="/assets/js/17.4163fba5.js"><link rel="prefetch" href="/assets/js/18.f89ce319.js"><link rel="prefetch" href="/assets/js/19.c4e1e9b5.js"><link rel="prefetch" href="/assets/js/20.557b1f39.js"><link rel="prefetch" href="/assets/js/21.1628db24.js"><link rel="prefetch" href="/assets/js/22.ac939110.js"><link rel="prefetch" href="/assets/js/3.605daa86.js"><link rel="prefetch" href="/assets/js/4.17fe7f49.js"><link rel="prefetch" href="/assets/js/6.d9897289.js"><link rel="prefetch" href="/assets/js/7.31f97fee.js"><link rel="prefetch" href="/assets/js/8.09438130.js"><link rel="prefetch" href="/assets/js/9.d7c02753.js">
    <link rel="stylesheet" href="/assets/css/0.styles.44111ffa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo_azure.svg" alt="Azure 中文精选" class="logo"> <span class="site-name can-hide">Azure 中文精选</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/content/cloud-advocate/" class="nav-link router-link-active">Cloud Advocate</a></div><div class="nav-item"><a href="/tags.html" class="nav-link">标签</a></div><div class="nav-item"><a href="https://forms.microsoft.com/Pages/ResponsePage.aspx?id=v4j5cvGGr0GRqy180BHbRxFo4UL6NOJLq2Kj3ObwvLdUNU04RVo1WU9RMVpTN081RlY2RE00NlJPNC4u" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我要参加翻译
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://azureselected.com/rss.xml" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RSS
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/azureselected/azureselected" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/content/cloud-advocate/" class="nav-link router-link-active">Cloud Advocate</a></div><div class="nav-item"><a href="/tags.html" class="nav-link">标签</a></div><div class="nav-item"><a href="https://forms.microsoft.com/Pages/ResponsePage.aspx?id=v4j5cvGGr0GRqy180BHbRxFo4UL6NOJLq2Kj3ObwvLdUNU04RVo1WU9RMVpTN081RlY2RE00NlJPNC4u" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我要参加翻译
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://azureselected.com/rss.xml" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RSS
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/azureselected/azureselected" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="getting-the-latest-array-item-with-inline-script-in-logic-app"><a href="#getting-the-latest-array-item-with-inline-script-in-logic-app" class="header-anchor">#</a> Getting the Latest Array Item with Inline Script in Logic App</h1> <p>In my <a href="https://devkimchi.com/2019/11/06/getting-the-latest-array-item-in-logic-app/" target="_blank" rel="noopener noreferrer">previous post<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, we’ve walked through a <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-overview?WT.mc_id=devkimchicom-blog-juyoo" target="_blank" rel="noopener noreferrer">Logic App<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> workflow to get the latest item in an array, by combining the <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-workflow-actions-triggers?WT.mc_id=devkimchicom-blog-juyoo#select-action" target="_blank" rel="noopener noreferrer"><code>Select</code> action<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and the <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-workflow-actions-triggers?WT.mc_id=devkimchicom-blog-juyoo#query-action" target="_blank" rel="noopener noreferrer"><code>Filter</code> action<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. In fact, although this approach is practical, it is only applicable for a few specific use cases, and a workaround, which is a bit tricky to apply in general. But, this preview feature, <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-add-run-inline-code?WT.mc_id=devkimchicom-blog-juyoo" target="_blank" rel="noopener noreferrer">Inline JavaScript Code action<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, can be handy for array sort. In this post, I’m going to discuss how to use the <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-add-run-inline-code?WT.mc_id=devkimchicom-blog-juyoo" target="_blank" rel="noopener noreferrer">Inline JavaScript Code action<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to sort array items and take the latest one in the Logic App workflow.</p> <h2 id="integration-account"><a href="#integration-account" class="header-anchor">#</a> Integration Account</h2> <p>In order to use this Inline JavaScript Code action, we have to provision an <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-enterprise-integration-create-integration-account?WT.mc_id=devkimchicom-blog-juyoo" target="_blank" rel="noopener noreferrer">Integration Account<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>instance. There are <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-pricing?WT.mc_id=devkimchicom-blog-juyoo#integration-accounts" target="_blank" rel="noopener noreferrer">three pricing tiers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> of Integration Account – Free, Basic and Standard. For our practice, the free one is more than enough.</p> <p>Once the Integration Account instance is provisioned, connect it with the existing Logic App instance to use the action.</p> <p><img src="https://sa0blogs.blob.core.windows.net/devkimchi/2019/11/getting-the-latest-array-item-with-inline-script-in-logic-app-03.png" alt="img"></p> <h2 id="javascript-support"><a href="#javascript-support" class="header-anchor">#</a> JavaScript Support</h2> <p>Currently, the action supports the <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects" target="_blank" rel="noopener noreferrer">built-in functions<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> of node.js <code>8.11.1</code>. We can’t import external libraries through <code>npm</code> or so. Therefore, we can’t rely on any <a href="https://nodejs.org/docs/latest-v8.x/api/modules.html#modules_require" target="_blank" rel="noopener noreferrer"><code>require()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> statement. Everything <strong>MUST</strong> stay in the action.</p> <h2 id="inline-javascript-code"><a href="#inline-javascript-code" class="header-anchor">#</a> Inline JavaScript Code</h2> <p>Let’s have a look at the JavaScript code below. It’s not related to Logic App but the pure JavaScript code. If you run this code in a node.js console, it returns the latest file path value of <code>20191104.json</code>, which is expected. <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/sort" target="_blank" rel="noopener noreferrer">Array sorting feature in JavaScript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> needs a separate callback function, which contains the sort logic.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> items <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;20191101.json&quot;</span><span class="token punctuation">,</span>
<span class="token string">&quot;Path&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;/path/20191101.json&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;20191102.json&quot;</span><span class="token punctuation">,</span>
<span class="token string">&quot;Path&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;/path/20191102.json&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;20191103.json&quot;</span><span class="token punctuation">,</span>
<span class="token string">&quot;Path&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;/path/20191103.json&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;20191104.json&quot;</span><span class="token punctuation">,</span>
<span class="token string">&quot;Path&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;/path/20191104.json&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> sorted <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">var</span> dateA <span class="token operator">=</span> a<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'.json'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> dateB <span class="token operator">=</span> b<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'.json'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// dateA is later than dateB: dateA gets the lower index.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>dateA <span class="token operator">&gt;</span> dateB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token comment">// dateA is older than dateB: dateB gets the lower index.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>dateA <span class="token operator">&lt;</span> dateB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token comment">// dateA and dateB is the same</span>
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> result <span class="token operator">=</span> sorted<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Path<span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The callback function <strong>SHOULD</strong> return either <code>-1</code>, <code>0</code> or <code>1</code>.</p> <ul><li>Returning <code>-1</code> means, between the array items <code>a</code> and <code>b</code>, <code>a</code> is sent to the lower index.</li> <li>Returning <code>1</code> means the array item <code>b</code> is sent to the lower index.</li></ul> <p>Therefore, the callback function gets rid of <code>.json</code> from the <code>Name</code> property value of both <code>a</code>and <code>b</code>, compare both values to each other, and the later (larger) one goes to the upper place of the array item (takes the lower index). In other words, the array items are sorted in descending order.</p> <blockquote><p>If you want to know more about the sort, please refer to <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#Description" target="_blank" rel="noopener noreferrer">this page<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></blockquote> <p>Now, let’s apply this code into Logic App.</p> <h2 id="inline-javascript-code-action"><a href="#inline-javascript-code-action" class="header-anchor">#</a> Inline JavaScript Code Action</h2> <p>Let’s add an action for <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-add-run-inline-code?WT.mc_id=devkimchicom-blog-juyoo" target="_blank" rel="noopener noreferrer">Inline JavaScript Code<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p><img src="https://sa0blogs.blob.core.windows.net/devkimchi/2019/11/getting-the-latest-array-item-with-inline-script-in-logic-app-01.png" alt="img"></p> <p>Then enter the JavaScript code in the action. It’s almost the same as the one in above, but there are two places changed for accommodation.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>


<span class="token comment">// Assign the array value from the output of the previous action, `List Backups`.</span>
<span class="token keyword">var</span> items <span class="token operator">=</span> workflowContext<span class="token punctuation">.</span>actions<span class="token punctuation">.</span>List_Backups<span class="token punctuation">.</span>outputs<span class="token punctuation">.</span>body<span class="token punctuation">.</span>value<span class="token punctuation">;</span>


<span class="token keyword">var</span> sorted <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> dateA <span class="token operator">=</span> a<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'.json'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> dateB <span class="token operator">=</span> b<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'.json'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


  <span class="token keyword">if</span> <span class="token punctuation">(</span>dateA <span class="token operator">&gt;</span> dateB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>


  <span class="token keyword">if</span> <span class="token punctuation">(</span>dateA <span class="token operator">&lt;</span> dateB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>


  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">var</span> result <span class="token operator">=</span> sorted<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Path<span class="token punctuation">;</span>


<span class="token comment">// Returns the result as output.</span>
<span class="token keyword">return</span> result<span class="token punctuation">;</span>
</code></pre></div><ul><li>The <code>items</code> variable takes the array items from the output of the previous action, <code>List Backups</code>.</li> <li>In the last line, it uses the <code>return</code> statement to send the result of the action to the <code>outputs</code> value.</li></ul> <p>If we want to refer the result of this action, any action later in this workflow can use <code>outputs('ACTION_NAME')?['body']</code>.</p> <h2 id="comparison"><a href="#comparison" class="header-anchor">#</a> Comparison</h2> <p>Now, we only use this Inline JavaScript Code action and sort out the issue (pun intended). Let’s compare the same result as the <a href="https://devkimchi.com/2019/11/06/getting-the-latest-array-item-in-logic-app/" target="_blank" rel="noopener noreferrer">previous post<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, with the picture below.</p> <p><img src="https://sa0blogs.blob.core.windows.net/devkimchi/2019/11/getting-the-latest-array-item-with-inline-script-in-logic-app-02.png" alt="img"></p> <p>The right-hand side is what we created in the <a href="https://devkimchi.com/2019/11/06/getting-the-latest-array-item-in-logic-app/" target="_blank" rel="noopener noreferrer">previous post<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. At least we <strong>SHOULD</strong> use both the <code>Select Filename from Backups</code> action (<code>Select</code>) and the <code>Take Latest Backup</code> action (<code>Filter</code>). If we want a more elegant way, a few extra actions are placed before and after.</p> <p>On the other hand, if we use the <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-add-run-inline-code?WT.mc_id=devkimchicom-blog-juyoo" target="_blank" rel="noopener noreferrer">Inline JavaScript Code action<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, like the left-hand side, we only need one action.</p> <p>But there’s a caveat. Make sure that we have to have the <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-enterprise-integration-create-integration-account?WT.mc_id=devkimchicom-blog-juyoo" target="_blank" rel="noopener noreferrer">Integration Account<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> associated with using this inline code action. The Integration Account is pretty expensive and fixed price – <a href="https://azure.microsoft.com/pricing/details/logic-apps/?WT.mc_id=devkimchicom-blog-juyoo" target="_blank" rel="noopener noreferrer">US$ 302.4 (Basic) and US$ 986.4 (Standard) per month<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. If your organisation has already been using the Integration Account, then it’s OK. However, if it hasn’t, it <strong>SHOULD</strong> be really careful.</p> <hr> <p>So far, we’ve walked through how to use the <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-add-run-inline-code?WT.mc_id=devkimchicom-blog-juyoo" target="_blank" rel="noopener noreferrer">Inline JavaScript Code action<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to sort array items within the Logic App workflow. It’s powerful but expensive. Therefore, only if your organisation takes the cost, use it.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/azureselected/azureselected/edit/master/content/cloud-advocate/getting-the-latest-array-item-with-inline-script-in-logic-app.md" target="_blank" rel="noopener noreferrer">在 GitHub 编辑本页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最近更新于:</span> <span class="time">12/18/2019, 5:49:13 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.4ac3a6ef.js" defer></script><script src="/assets/js/2.5f974afc.js" defer></script><script src="/assets/js/16.1df4917f.js" defer></script><script src="/assets/js/5.90cdf109.js" defer></script>
  </body>
</html>
